---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Section from '../components/Section.astro';
import ServiceCard from '../components/ServiceCard.astro';
import TeamMember from '../components/TeamMember.astro';
import ContactInfo from '../components/ContactInfo.astro';
import TestimonialCard from '../components/TestimonialCard.astro';
import FAQItem from '../components/FAQItem.astro';
import WhatsAppButton from '../components/WhatsAppButton.astro';
import Footer from '../components/Footer.astro';
import { Icon } from 'astro-icon/components';
import { services, teamMembers, contactItems, testimonials, faqs, clients, stats } from '../data/content';
---

<Layout>
	<main class="min-h-screen">
		<Navbar />

		<!-- Hero Section -->
		<section class="min-h-screen flex items-center justify-center relative overflow-hidden pt-20">
			<div class="max-w-7xl mx-auto px-8">
				<div class="relative z-10 text-center max-w-4xl animate-fade-in-up">
					<h1 class="text-5xl md:text-7xl lg:text-8xl font-bold mb-4 tracking-tight text-dark">
						Cogni<span class="text-turquoise relative">Code</span>
					</h1>
					<p class="text-xl md:text-2xl font-light text-gray-custom mb-8 tracking-wide">
						Inteligencia en el núcleo de tu estrategia
					</p>
					<p class="text-lg text-gray-custom max-w-2xl mx-auto mb-12 leading-relaxed">
						Transformamos ideas en soluciones tecnológicas inteligentes.
						Desarrollo de software estratégico para empresas que piensan en el futuro.
					</p>
					<div class="flex gap-4 justify-center flex-wrap">
						<a href="#servicios" class="group px-8 py-4 text-base font-semibold no-underline rounded-lg transition-all duration-300 bg-turquoise text-white shadow-[0_4px_15px_rgba(6,182,212,0.3)] hover:bg-turquoise-dark hover:-translate-y-0.5 hover:shadow-[0_6px_20px_rgba(6,182,212,0.4)] flex items-center gap-2">
							<span>Nuestros Servicios</span>
							<Icon name="lucide:arrow-right" class="w-5 h-5 group-hover:translate-x-1 transition-transform" />
						</a>
						<a href="#contacto" class="group px-8 py-4 text-base font-semibold no-underline rounded-lg transition-all duration-300 bg-transparent text-dark border-2 border-turquoise hover:bg-turquoise hover:text-white hover:-translate-y-0.5 flex items-center gap-2">
							<Icon name="lucide:message-circle" class="w-5 h-5" />
							<span>Contactar</span>
						</a>
					</div>
				</div>
			</div>
			<div class="absolute -top-[10%] -right-[10%] w-[600px] h-[600px] bg-gradient-to-br from-turquoise-light to-turquoise rounded-full opacity-10 z-0 animate-float"></div>
		</section>

		<!-- Servicios Section -->
		<Section id="servicios" title="Nuestros Servicios" bgColor="gray">
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
				{services.map(service => (
					<ServiceCard {...service} />
				))}
			</div>
		</Section>

		<!-- Clientes Section -->
		<Section id="clientes" title="Clientes que Confían en Nosotros" subtitle="Empresas líderes que han transformado su visión tecnológica con CogniCode">
			<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-12">
				{clients.map(client => (
					<div class="flex items-center justify-center p-8 text-2xl font-semibold text-gray-custom border-2 border-slate-200 rounded-lg transition-all duration-300 hover:border-turquoise hover:text-turquoise hover:scale-105">
						{client}
					</div>
				))}
			</div>
		</Section>

		<!-- Sobre Nosotros Section -->
		<Section id="nosotros" title="Sobre Nosotros" bgColor="gray">
			<div class="max-w-4xl mx-auto">
				<p class="text-lg leading-relaxed text-gray-custom mb-6">
					En <strong class="text-turquoise">CogniCode</strong>, fusionamos inteligencia y tecnología para crear soluciones 
					que transforman negocios. Nuestro equipo de expertos combina pensamiento estratégico con excelencia técnica.
				</p>
				<p class="text-lg leading-relaxed text-gray-custom mb-6">
					Con años de experiencia en el sector tecnológico, nos especializamos en 
					identificar el núcleo de los desafíos empresariales y desarrollar soluciones 
					innovadoras que generan resultados medibles.
				</p>
				<div class="grid grid-cols-1 md:grid-cols-3 gap-12 mt-16">
					{stats.map(stat => (
						<div class="text-center">
							<div class="text-5xl font-bold text-turquoise mb-2">{stat.number}</div>
							<div class="text-gray-custom text-base">{stat.label}</div>
						</div>
					))}
				</div>
			</div>
		</Section>

		<!-- Colaboradores Section -->
		<Section id="colaboradores" title="Nuestro Equipo" subtitle="Profesionales apasionados por la tecnología y la innovación">
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12">
				{teamMembers.map(member => (
					<TeamMember {...member} />
				))}
			</div>
		</Section>

		<!-- Testimonios Section -->
		<Section id="testimonios" title="Lo Que Dicen Nuestros Clientes" subtitle="Historias de éxito de quienes confiaron en nosotros" bgColor="gray">
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
				{testimonials.map(testimonial => (
					<TestimonialCard {...testimonial} />
				))}
			</div>
		</Section>

		<!-- FAQ Section -->
		<section id="faq" class="py-32 bg-white">
			<div class="max-w-4xl mx-auto px-8">
				<h2 class="text-4xl md:text-5xl lg:text-6xl font-bold text-center mb-4 text-dark relative after:content-[''] after:block after:w-20 after:h-1 after:bg-turquoise after:mt-4 after:mx-auto after:rounded">
					Preguntas Frecuentes
				</h2>
				<p class="text-center text-gray-custom text-lg mb-16 max-w-2xl mx-auto">
					Respuestas a las dudas más comunes sobre nuestros servicios
				</p>
				<div class="space-y-4 mt-16">
					{faqs.map(faq => (
						<FAQItem {...faq} />
					))}
				</div>
			</div>
		</section>

		<!-- Contacto Section -->
		<section id="contacto" class="py-32 bg-light-gray">
			<div class="max-w-7xl mx-auto px-8">
				<h2 class="text-4xl md:text-5xl lg:text-6xl font-bold text-center mb-4 text-dark relative after:content-[''] after:block after:w-20 after:h-1 after:bg-turquoise after:mt-4 after:mx-auto after:rounded">
					Hablemos de tu Proyecto
				</h2>
				<p class="text-center text-gray-custom text-lg mb-16 max-w-2xl mx-auto">
					Estamos listos para convertir tu visión en realidad
				</p>
				<div class="grid grid-cols-1 lg:grid-cols-[1fr_1.5fr] gap-16 mt-16">
					<div class="flex flex-col gap-8">
						{contactItems.map(item => (
							<ContactInfo {...item} />
						))}
					</div>
					<form action="https://api.web3forms.com/submit" method="POST" id="contact-form" class="flex flex-col gap-6">
						<input type="hidden" name="access_key" value="8dc97aae-bd7d-4fef-be4b-c8e96cd7c6d6">
						<input type="hidden" name="subject" value="Nuevo mensaje de contacto desde CogniCode">
						<input type="hidden" name="from_name" value="Formulario CogniCode">
						
						<div class="relative">
							<input type="text" name="name" placeholder="Nombre completo" required class="w-full p-4 border-2 border-slate-200 rounded-lg font-sans text-base transition-all focus:outline-none focus:border-turquoise focus:ring-2 focus:ring-turquoise/20">
						</div>
						<div class="relative">
							<input type="email" name="email" placeholder="Email" required class="w-full p-4 border-2 border-slate-200 rounded-lg font-sans text-base transition-all focus:outline-none focus:border-turquoise focus:ring-2 focus:ring-turquoise/20">
						</div>
						<div class="relative">
							<input type="text" name="company" placeholder="Empresa" class="w-full p-4 border-2 border-slate-200 rounded-lg font-sans text-base transition-all focus:outline-none focus:border-turquoise focus:ring-2 focus:ring-turquoise/20">
						</div>
						<div class="relative">
							<textarea name="message" placeholder="Cuéntanos sobre tu proyecto" rows="5" required class="w-full p-4 border-2 border-slate-200 rounded-lg font-sans text-base transition-all focus:outline-none focus:border-turquoise focus:ring-2 focus:ring-turquoise/20 resize-none"></textarea>
						</div>
						<button type="submit" class="group w-fit px-8 py-4 text-base font-semibold rounded-lg transition-all duration-300 bg-turquoise text-white shadow-[0_4px_15px_rgba(6,182,212,0.3)] hover:bg-turquoise-dark hover:-translate-y-0.5 hover:shadow-[0_6px_20px_rgba(6,182,212,0.4)] disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
							<span>Enviar Mensaje</span>
							<Icon name="lucide:send" class="w-5 h-5 group-hover:translate-x-1 transition-transform" />
						</button>
						<div id="form-message" class="hidden p-4 rounded-lg text-center font-medium"></div>
					</form>
				</div>
			</div>
		</section>

		<Footer />
		
		<!-- WhatsApp Floating Button -->
		<WhatsAppButton phoneNumber="51902415972" message="Hola CogniCode, me gustaría saber más sobre sus servicios" />
	</main>
</Layout>

<script>
	// Scroll reveal animations
	const observerOptions = {
		threshold: 0.1,
		rootMargin: '0px 0px -50px 0px'
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach(entry => {
			if (entry.isIntersecting) {
				const element = entry.target as HTMLElement;
				element.style.opacity = '1';
				element.style.transform = 'translateY(0)';
				element.style.transition = 'opacity 0.8s ease-out, transform 0.8s ease-out';
				observer.unobserve(entry.target);
			}
		});
	}, observerOptions);

	// Observe all sections
	document.addEventListener('DOMContentLoaded', () => {
		const sections = document.querySelectorAll('section:not(.min-h-screen)');
		sections.forEach(section => {
			const element = section as HTMLElement;
			element.style.opacity = '0';
			element.style.transform = 'translateY(30px)';
			observer.observe(section);
		});

		// Add scroll-based navbar background
		const navbar = document.querySelector('nav');
		window.addEventListener('scroll', () => {
			if (window.scrollY > 100) {
				navbar?.classList.add('shadow-lg');
			} else {
				navbar?.classList.remove('shadow-lg');
			}
		});

		// Contact form handling with Web3Forms
		const contactForm = document.getElementById('contact-form') as HTMLFormElement;
		const formMessage = document.getElementById('form-message');

		contactForm?.addEventListener('submit', async (e) => {
			e.preventDefault();
			
			const submitButton = contactForm.querySelector('button[type="submit"]') as HTMLButtonElement;
			const originalText = submitButton.innerHTML;
			
			// Disable button and show loading
			submitButton.disabled = true;
			submitButton.innerHTML = '<span>Enviando...</span>';
			
			try {
				const formData = new FormData(contactForm);
				const response = await fetch('https://api.web3forms.com/submit', {
					method: 'POST',
					body: formData
				});

				const data = await response.json();

				if (data.success) {
					// Show success message
					if (formMessage) {
						formMessage.classList.remove('hidden', 'bg-red-100', 'text-red-700');
						formMessage.classList.add('bg-green-100', 'text-green-700');
						formMessage.textContent = '¡Mensaje enviado con éxito! Nos pondremos en contacto pronto.';
					}
					
					// Reset form
					contactForm.reset();
					
					// Hide message after 5 seconds
					setTimeout(() => {
						formMessage?.classList.add('hidden');
					}, 5000);
				} else {
					throw new Error(data.message || 'Error al enviar el formulario');
				}
			} catch (error) {
				// Show error message
				if (formMessage) {
					formMessage.classList.remove('hidden', 'bg-green-100', 'text-green-700');
					formMessage.classList.add('bg-red-100', 'text-red-700');
					formMessage.textContent = 'Hubo un error al enviar el mensaje. Por favor, intenta nuevamente.';
				}
				
				// Hide error message after 5 seconds
				setTimeout(() => {
					formMessage?.classList.add('hidden');
				}, 5000);
			} finally {
				// Re-enable button
				submitButton.disabled = false;
				submitButton.innerHTML = originalText;
			}
		});
	});
</script>

<style>
	@keyframes fadeInUp {
		from {
			opacity: 0;
			transform: translateY(30px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.animate-fade-in-up {
		animation: fadeInUp 0.8s ease-out forwards;
	}
</style>
